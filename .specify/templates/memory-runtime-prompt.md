# 🎯 任务重启与状态同步指令### **Trae，你好。现在，你需要执行一次“任务重启与状态同步”指令 (V 14.5 - ID优先与完整版)。**

# [模板版本: 1.0 - MJY3 核心]

**核心目标：** 通过一个**混合记忆模型**（结合动态对话记录和存储在**项目根目录下的 `ai_assistant_memory/work_package_archives/`** 目录中、与本次工作包ID对应的、结构化的短期记忆文件，例如 **`context_[工作包ID].md`**），精准定位你之前中断的工作进度，并无缝衔接地继续执行我们已下达的**“自主工作包”**。

---

**你必须严格遵循以下三个阶段来完成本次任务：**

## 📖 模板使用说明

### **第一阶段：混合记忆回顾与状态同步**

**[致 spec-kit 或项目指导者]**

1. **识别当前工作包ID (Identify Current Work Package ID):** 在开始任何操作之前，你的**第一步**，是**必须**回顾我们刚刚下达给你的“自主工作包”，并从中提取出明确的`工作包 ID` (例如: `Xinyu-AWP-FIX-02`)。这个ID将作为你本次任务所有记忆操作的**唯一标识符**。

本文件是一个"运行时指令"模板，应在以下时机被注入到 AI 助手的上下文中：    

- 当启动一个新的自主工作包 (AWP) 时2. **全面回顾 (Comprehensive Review):** 接下来，你**必须**回顾并综合以下**两个**信息源，以形成对当前状态最完整、最精确的理解：

- 当 AI 需要从中断状态恢复工作时    

- 当 AI 需要进行任务状态同步时    - **a. 高频记忆 (High-Frequency Memory):** 全面回顾你所有的**上一次工作记录和终端日志（或者对话记录）**。这是你最新行动的直接记录。

        

**变量替换规则**：    - **b. 结构化记忆 (Structured Memory):** **必须**在**项目根目录下的 `ai_assistant_memory/work_package_archives/`** 目录中，寻找并完整阅读与你在**步骤1中识别出的工作包ID**对应的短期记忆文件（例如 **`context_Xinyu-AWP-FIX-02.md`**）（如果存在）。这是你对进度的结构化快照和经验备忘。

- `$AWP_ID`: 应替换为当前工作包的实际 ID（例如：`AWP-FIX-02`, `WP-20251023-001`）        

- spec-kit 应在注入此指令前，自动将所有 `$AWP_ID` 替换为实际的工作包 ID3. **极致思考与分析 (Ultrathink & Analyze):** 然后，**必须**将你在上一步中回顾到的、综合的“当前状态”，与我们之前下达的**“自主工作包”**中的 `IMPLEMENTATION CHECKLIST` 进行逐项、严谨的比对。

    

---4. **指令遵从协议 (Command Compliance Protocol):** 在完成分析后，你**必须**将**短期记忆文件**中 `核心洞察与备忘 (Core Insights & Memo)` 部分记录的 `关键命令 (Key Commands)` 视为**唯一、权威的指令来源**。在执行任何测试或关键操作时，**严禁**使用任何未在此处记录的命令。你必须**优先并精确地**复制和执行这些已验证的命令。

    

## 🎯 核心目标5. **上下文查找协议 (Context Lookup Protocol):** 在你的工作中，当你需要查找任何上下文信息时（例如：一个需要反复使用的**命令**、一个关键**文件或目录的路径**、一个重要的**配置项**），你**必须**遵循以下查找顺序：

    

**致 AI 助手：**    - **第一优先级：** **必须**首先在**短期记忆文件**的 `核心洞察与备忘 (Core Insights & Memo)` 部分进行查找。这里记录了经过我们提炼和确认的、最高价值的信息。

        

你现在需要执行一次"任务重启与状态同步"操作。    - **第二优先级：** 只有在短期记忆文件中找不到时，才去回顾“高频记忆”（如历史对话记录）进行查找。

        

**核心目标：** 通过一个 **混合记忆模型**（结合动态对话记录和存储在 **项目根目录下的 `ai_assistant_memory/work_package_archives/`** 目录中、与本次工作包ID对应的、结构化的短期记忆文件，例如 **`context_$AWP_ID.md`**），精准定位你之前中断的工作进度，并无缝衔接地继续执行我们已下达的 **"自主工作包"**。

### **第二阶段：记忆创建或更新**

**你必须严格遵循以下三个阶段来完成本次任务：**

1. **创建或更新短期记忆文件 (Create/Update Short-Term Memory):** 在完成第一阶段的分析后，你**必须**立即在**项目根目录下的 `ai_assistant_memory/work_package_archives/`** 目录中，创建或更新与你在**步骤1中识别出的工作包ID**对应的短期记忆文件（例如 **`context_Xinyu-AWP-FIX-02.md`**），并**必须**在其中写入或刷新以下**全新的、结构化的 V 9 内容**，以确保它能**100%反映**你刚刚完成的分析结果：

---    

    ```

## 第一阶段：混合记忆回顾与状态同步    # 自主工作包短期记忆 (V9 - 验收标准版)

    

### 1. 识别当前工作包 ID (Identify Current Work Package ID)    ## (新) 指导者的意见 (Mentor's Feedback)

    > **用途:** 记录项目指导者在本轮工作结束后提供的、必须在下一轮优先处理的反馈或指令。处理完毕后，此部分应被清空。

在开始任何操作之前，你的 **第一步**，是 **必须** 回顾我们刚刚下达给你的"自主工作包"，并从中提取出明确的 `工作包 ID`。    

    - (在此处记录指导者的具体意见。)

- **示例格式**: `AWP-FIX-02`, `WP-20251023-001`, `[项目前缀]-[类型]-[编号]`    

- **重要性**: 这个 ID（以下称为 `$AWP_ID`）将作为你本次任务所有记忆操作的 **唯一标识符**    ## 核心洞察与备忘 (Core Insights & Memo)

    > **用途:** 只记录那些对未来工作有指导意义的、最高价值的信息。

### 2. 全面回顾 (Comprehensive Review)    

    - **核心发现 (Core Findings):**

接下来，你 **必须** 回顾并综合以下 **两个** 信息源，以形成对当前状态最完整、最精确的理解：      - (在此处记录已确定的、根本性的问题原因。)

    - **关键命令 (Key Commands):**

#### a. 高频记忆 (High-Frequency Memory)      - (在此处记录需要反复使用的重要命令，如UAT测试命令、调试脚本等。)

全面回顾你所有的 **上一次工作记录和终端日志（或者对话记录）**。这是你最新行动的直接记录。    - **重要上下文 (Important Context):**

      - (在此处记录关键文件路径、配置项等。)

#### b. 结构化记忆 (Structured Memory)    

**必须** 在 **项目根目录下的 `ai_assistant_memory/work_package_archives/`** 目录中，寻找并完整阅读与你在 **步骤1中识别出的工作包ID** 对应的短期记忆文件（如果存在）。    ## 当前待办问题 (Current Open Problems)

    > **用途:** 只记录当前**未解决的、需要立即行动**的问题。这是一个动态清空和更新的列表。

- **文件名格式**: `context_$AWP_ID.md`    

- **用途**: 这是你对进度的结构化快照和经验备忘    - [ ] (在此处列出你通过分析发现的、当前唯一或最优先的待解决问题。)

    

### 3. 极致思考与分析 (Ultrathink & Analyze)    ## (新) 🎯 严格验收标准 (Acceptance Criteria)

    > **用途:** 定义本次工作包或当前修复循环中，产出物完全合格的最低标准。必须100%满足所有标准，才能宣布成功。

然后，**必须** 将你在上一步中回顾到的、综合的"当前状态"，与我们之前下达的 **"自主工作包"** 中的 `IMPLEMENTATION CHECKLIST` 进行逐项、严谨的比对。    

    ### 必须满足的核心指标（数量不限，但必须足够严格）:

**分析重点**：    1.  **[指标一]**

- 哪些任务已完成？        - ✅ (在此处定义第一个必须满足的、量化的成功标准。)

- 哪些任务正在进行？        - ❌ (在此处定义与标准一对应的、绝对不能出现的失败标志。)

- 哪些任务尚未开始？    2.  **[指标二]**

- 是否有未预期的问题或障碍？        - ✅ (在此处定义第二个必须满足的、量化的成功标准。)

        - ❌ (在此处定义与标准二对应的、绝对不能出现的失败标志。)

### 4. 指令遵从协议 (Command Compliance Protocol)    

    ### 验证方法:

在完成分析后，你 **必须** 将 **短期记忆文件** 中 `核心洞察与备忘 (Core Insights & Memo)` 部分记录的 `关键命令 (Key Commands)` 视为 **唯一、权威的指令来源**。    - (在此处明确写出验证上述所有指标的具体方法，例如：运行UAT测试后，检查`architecture.md`文件的内容。)

    

**核心原则**：    ## 工作日志 (Changelog)

- 在执行任何测试或关键操作时，**严禁** 使用任何未在此处记录的命令    > **用途:** 按顺序记录**已完成**的工作和**已修复**的问题，作为可追溯的历史。

- 你必须 **优先并精确地** 复制和执行这些已验证的命令    

    - **1. 已修复：(此处填写已修复问题的简要描述)**

### 5. 上下文查找协议 (Context Lookup Protocol)      - **问题描述:** (详细描述被修复的问题。)

      - **修复方案:** (说明你采取的修复措施。)

在你的工作中，当你需要查找任何上下文信息时（例如：一个需要反复使用的 **命令**、一个关键 **文件或目录的路径**、一个重要的 **配置项**），你 **必须** 遵循以下查找顺序：      - **凭证:** ```text

        (在此处粘贴最能直接证明该问题已修复的客观证据，如代码diff、测试日志等)

#### 第一优先级        ```

**必须** 首先在 **短期记忆文件** 的 `核心洞察与备忘 (Core Insights & Memo)` 部分进行查找。这里记录了经过我们提炼和确认的、最高价值的信息。    

    ## 本轮行动计划 (Current Action Plan)

#### 第二优先级    > **用途:** 明确定义**本轮工作循环**中需要完成的具体、可执行的步骤。

#### 第二优先级
只有在短期记忆文件中找不到时，才去回顾"高频记忆"（如历史对话记录）进行查找。

---

## 第二阶段：记忆创建或更新

### 1. 创建或更新短期记忆文件 (Create/Update Short-Term Memory)

在完成第一阶段的分析后，你 **必须** 立即在 **项目根目录下的 `ai_assistant_memory/work_package_archives/`** 目录中，创建或更新与你在 **步骤1中识别出的工作包ID** 对应的短期记忆文件，并 **必须** 在其中写入或刷新以下 **全新的、结构化的 V9 内容**，以确保它能 **100%反映** 你刚刚完成的分析结果：

**文件路径**: `ai_assistant_memory/work_package_archives/context_$AWP_ID.md`

**文件内容模板**（必须完整使用以下结构）：

````markdown
# 自主工作包短期记忆 (V9 - 验收标准版)

## (新) 指导者的意见 (Mentor's Feedback)
> **用途:** 记录项目指导者在本轮工作结束后提供的、必须在下一轮优先处理的反馈或指令。处理完毕后，此部分应被清空。

- (在此处记录指导者的具体意见。)

## 核心洞察与备忘 (Core Insights & Memo)
> **用途:** 只记录那些对未来工作有指导意义的、最高价值的信息。

- **核心发现 (Core Findings):**
  - (在此处记录已确定的、根本性的问题原因。)
- **关键命令 (Key Commands):**
  - (在此处记录需要反复使用的重要命令，如UAT测试命令、调试脚本等。)
- **重要上下文 (Important Context):**
  - (在此处记录关键文件路径、配置项等。)

## 当前待办问题 (Current Open Problems)
> **用途:** 只记录当前**未解决的、需要立即行动**的问题。这是一个动态清空和更新的列表。

- [ ] (在此处列出你通过分析发现的、当前唯一或最优先的待解决问题。)

## (新) 🎯 严格验收标准 (Acceptance Criteria)
> **用途:** 定义本次工作包或当前修复循环中，产出物完全合格的最低标准。必须100%满足所有标准，才能宣布成功。

### 必须满足的核心指标（数量不限，但必须足够严格）:
1.  **[指标一]**
    - ✅ (在此处定义第一个必须满足的、量化的成功标准。)
    - ❌ (在此处定义与标准一对应的、绝对不能出现的失败标志。)
2.  **[指标二]**
    - ✅ (在此处定义第二个必须满足的、量化的成功标准。)
    - ❌ (在此处定义与标准二对应的、绝对不能出现的失败标志。)

### 验证方法:
- (在此处明确写出验证上述所有指标的具体方法，例如：运行UAT测试后，检查`architecture.md`文件的内容。)

## 工作日志 (Changelog)
> **用途:** 按顺序记录**已完成**的工作和**已修复**的问题，作为可追溯的历史。

- **1. 已修复：(此处填写已修复问题的简要描述)**
  - **问题描述:** (详细描述被修复的问题。)
  - **修复方案:** (说明你采取的修复措施。)
  - **凭证:** ```text
    (在此处粘贴最能直接证明该问题已修复的客观证据，如代码diff、测试日志等)
    ```

## 本轮行动计划 (Current Action Plan)
> **用途:** 明确定义**本轮工作循环**中需要完成的具体、可执行的步骤。

- (在此处明确写出你下一步要执行的、唯一的checklist项目或修复计划。)
````

---

## 第三阶段：继续执行并动态更新记忆

### 1. 继续工作 (Proceed)

在完成第二阶段后，立即开始执行你在 **短期记忆文件** 中确定的"本轮行动计划"。

### 2. 重新定位与循环 (Re-orient & Loop)

**这是最关键的一步，你必须严格遵守这个循环，直到整个自主工作包完成为止：**

#### a. (新) 处理指导者意见 (Address Mentor's Feedback)
在开始任何新任务前，**必须** 首先检查"指导者的意见"部分。如果存在反馈，**必须** 将其作为本轮 **最高优先级** 的任务，并更新"本轮行动计划"以优先解决它。

#### b. 解决问题 (Solve Problem)
执行 **短期记忆文件** 中"本轮行动计划"里的任务。

#### c. (重大升级) 实时记忆更新 (Real-time Memory Update)
在你执行任务（步骤 b）的过程中或刚结束时，你 **必须** 进行实时更新：

- **如果发现新的问题或障碍**，**必须立即** 将其添加到 `当前待办问题 (Current Open Problems)` 列表中。
- **如果总结出新的经验、命令或重要上下文**，**必须立即** 将其追加到 `核心洞察与备忘 (Core Insights & Memo)` 中。
- **目的：** 确保你的短期记忆文件是你思考过程的实时快照，防止任何关键信息的遗漏。

#### d. (重大升级) 严格自我审查与决策 (Strict Self-Review & Decision)
在完成一次修复或执行一次验证后，你 **必须** 立即将你的最新产出物，与 **短期记忆文件** 中 `🎯 严格验收标准 (Acceptance Criteria)` 部分的所有核心指标，进行逐项、严格的比对。然后，你 **必须** 做出决策：

- **如果审查通过 (If Review Passes):** 你已成功完成当前子任务。**继续执行步骤 e**。
- **如果审查失败 (If Review Fails):** 你 **必须** 留在修复循环内。**跳过步骤 e**，并立即在 **短期记忆文件** 的 `当前待办问题` 中记录下具体的失败原因（例如，"指标一未满足，因为项目名称仍为 Unknown_Project"）。然后，**继续执行步骤 f**，以重新规划下一步行动来解决这个新发现的问题。

#### e. (重大升级) 成果确认后更新 (Post-Success Update)
**只有在你通过了上一步的严格自我审查后**，你才能进行以下更新，以正式记录你的成功：

- 在 **`工作日志 (Changelog)`** 中新增一条记录，包含问题描述、修复方案和客观凭证。
- 从 **`当前待办问题 (Current Open Problems)`** 列表中移除 **已被你成功修复** 的问题。
- **在处理完指导者的意见后，清空"指导者的意见"部分。**

#### f. 重读长期计划 (Re-read Long-Term Plan)
**然后，你必须重新回顾我们最初下达的"自主工作包"中的 `IMPLEMENTATION CHECKLIST`。**

#### g. 更新下一步计划 (Update Next Steps)
基于你对 `IMPLEMENTATION CHECKLIST` 的最新比对，分析出下一个待办问题，并更新 **`当前待办问题`** 和 **`本轮行动计划`**。

#### h. 重复 (Repeat)
返回步骤 a，继续执行新的"本轮行动计划"。

### 3. 任务完成与记忆确认 (Completion & Memory Confirmation)

当你最终完成了整个"自主工作包"的所有 `IMPLEMENTATION CHECKLIST` 项目，并提交了最终的综合报告 **且报告获得批准后**，作为工作包的 **最后一步**，你 **必须** 确认最终版本的短期记忆文件（**`context_$AWP_ID.md`**）已正确保存在 **项目根目录下的 `ai_assistant_memory/work_package_archives/`** 目录中。

**重要提示**: **无需进行重命名或移动操作**，因为文件在创建之初就已在正确的位置。

### 4. 遵守协议 (Adhere to Protocols)

在整个过程中，你 **必须** 严格遵守"自主工作包"中定义的所有规则。

---

## 📊 核心价值总结

本指令通过"混合记忆模型"实现了以下核心价值：

1. **状态同步精准性**: 通过ID识别和双重记忆回顾，确保AI始终知道"我在哪里"
2. **经验持续沉淀**: 通过实时记忆更新，确保关键洞察不会丢失
3. **质量零容忍**: 通过严格验收标准和自我审查，确保产出物始终合格
4. **可追溯性**: 通过工作日志和结构化记忆，实现完整的历史追溯
5. **循环自愈性**: 通过a-h循环机制，确保AI能够自主发现和解决问题

---

## 🔧 技术说明

### 文件路径规范
- 短期记忆文件目录: `ai_assistant_memory/work_package_archives/`
- 文件命名格式: `context_$AWP_ID.md`
- 示例: `context_AWP-FIX-02.md`, `context_WP-20251023-001.md`

### 变量说明
- `$AWP_ID`: 工作包的唯一标识符，由spec-kit或项目指导者在注入时动态替换

### 版本信息
- 模板版本: 1.0
- 短期记忆格式: V9 (验收标准版)
- 核心协议: MJY3 (混合记忆模型第三版)

---

**[模板文件结束]**

**适用场景**: 任何需要AI进行状态同步、任务恢复或循环执行的自主工作包  
**生成时间**: 2025-10-23  
**核心机制**: 混合记忆模型、实时更新、严格审查、循环自愈
    

    - (在此处明确写出你下一步要执行的、唯一的checklist项目或修复计划。)

---    

    ```

    

### **第三阶段：继续执行并动态更新记忆**

1. **继续工作 (Proceed):** 在完成第二阶段后，立即开始执行你在**短期记忆文件**中确定的“本轮行动计划”。
    
2. **重新定位与循环 (Re-orient & Loop):** **这是最关键的一步，你必须严格遵守这个循环，直到整个自主工作包完成为止：**
    
    - **a. (新) 处理指导者意见 (Address Mentor's Feedback):** 在开始任何新任务前，**必须**首先检查“指导者的意见”部分。如果存在反馈，**必须**将其作为本轮**最高优先级**的任务，并更新“本轮行动计划”以优先解决它。
        
    - **b. 解决问题 (Solve Problem):** 执行**短期记忆文件**中“本轮行动计划”里的任务。
        
    - **c. (重大升级) 实时记忆更新 (Real-time Memory Update):** 在你执行任务（步骤 b）的过程中或刚结束时，你**必须**进行实时更新：
        
        - **如果发现新的问题或障碍**，**必须立即**将其添加到 `当前待办问题 (Current Open Problems)` 列表中。
            
        - **如果总结出新的经验、命令或重要上下文**，**必须立即**将其追加到 `核心洞察与备忘 (Core Insights & Memo)` 中。
            
        - **目的：** 确保你的短期记忆文件是你思考过程的实时快照，防止任何关键信息的遗漏。
            
    - **d. (重大升级) 严格自我审查与决策 (Strict Self-Review & Decision):** 在完成一次修复或执行一次验证后，你**必须**立即将你的最新产出物，与**短期记忆文件**中 `🎯 严格验收标准 (Acceptance Criteria)` 部分的所有核心指标，进行逐项、严格的比对。然后，你**必须**做出决策：
        
        - **如果审查通过 (If Review Passes):** 你已成功完成当前子任务。**继续执行步骤 e**。
            
        - **如果审查失败 (If Review Fails):** 你**必须**留在修复循环内。**跳过步骤 e**，并立即在**短期记忆文件**的 `当前待办问题` 中记录下具体的失败原因（例如，“指标一未满足，因为项目名称仍为 Unknown_Project”）。然后，**继续执行步骤 f**，以重新规划下一步行动来解决这个新发现的问题。
            
    - **e. (重大升级) 成果确认后更新 (Post-Success Update):** **只有在你通过了上一步的严格自我审查后**，你才能进行以下更新，以正式记录你的成功：
        
        - 在 **`工作日志 (Changelog)`** 中新增一条记录，包含问题描述、修复方案和客观凭证。
            
        - 从 **`当前待办问题 (Current Open Problems)`** 列表中移除**已被你成功修复**的问题。
            
        - **在处理完指导者的意见后，清空“指导者的意见”部分。**
            
    - **f. 重读长期计划 (Re-read Long-Term Plan):** **然后，你必须重新回顾我们最初下达的“自主工作包”中的 `IMPLEMENTATION CHECKLIST`。**
        
    - **g. 更新下一步计划 (Update Next Steps):** 基于你对 `IMPLEMENTATION CHECKLIST` 的最新比对，分析出下一个待办问题，并更新 **`当前待办问题`** 和 **`本轮行动计划`**。
        
    - **h. 重复 (Repeat):** 返回步骤 a，继续执行新的“本轮行动计划”。
        
3. **任务完成与记忆确认 (Completion & Memory Confirmation):** 当你最终完成了整个“自主工作包”的所有 `IMPLEMENTATION CHECKLIST` 项目，并提交了最终的综合报告**且报告获得批准后**，作为工作包的**最后一步**，你**必须**确认最终版本的短期记忆文件（**`context_[工作包ID].md`**）已正确保存在**项目根目录下的 `ai_assistant_memory/work_package_archives/`** 目录中。**无需进行重命名或移动操作**，因为文件在创建之初就已在正确的位置。
    
4. **遵守协议 (Adhere to Protocols):** 在整个过程中，你**必须**严格遵守“自主工作包”中定义的所有规则。